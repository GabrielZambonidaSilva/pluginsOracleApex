let elemCheckArr=[{queryCheckAll:".selectAllA",collectionName:"checkbox",buttonClear:"#button",clearCollectionOnPageLoad:!1,checkColumn:{queryCheck:".selectChild",attrValue:"data-id"}},{queryCheckAll:".selectAllB",collectionName:"checkboxB",buttonClear:"#button2",clearCollectionOnPageLoad:!0,checkColumn:{queryCheck:".selectChildb",attrValue:"data-id"}}],staticRegion="#staticRegion ",elemObj={id:null,checked:!1,collectionName:null};function createCollection(e){let c=[];e.forEach(e=>{c.push({collectionName:e.collectionName,clearCollectionOnPageLoad:e.clearCollectionOnPageLoad})}),apex.server.process("CHANGE_COLLECTION",{x01:"CREATE",f01:JSON.stringify(c)}).done(e=>{console.log(e)}).fail(e=>{console.warn(e)})}function changeCollection(e){let c=Array.from(e);c.forEach(e=>{eventCheckBox({staticRegion:staticRegion,queryCheckAll:elemCheckArr.filter(c=>c.collectionName==e.collectionName)[0].queryCheckAll,queryCheck:elemCheckArr.filter(c=>c.collectionName==e.collectionName)[0].checkColumn.queryCheck,disable:!0})}),apex.server.process("CHANGE_COLLECTION",{x01:"CHANGE",f01:JSON.stringify(c)}).done(e=>{console.log(e)}).fail(e=>{console.warn(e)}).always(e=>{c.forEach(e=>{eventCheckBox({staticRegion:staticRegion,queryCheckAll:elemCheckArr.filter(c=>c.collectionName==e.collectionName)[0].queryCheckAll,queryCheck:elemCheckArr.filter(c=>c.collectionName==e.collectionName)[0].checkColumn.queryCheck,disable:!1})})})}function listCollection(e){let c=Array.from(e),l=[];c.forEach(e=>{console.log(e),l.push({collectionName:e.collectionName,ids:Array.from($(staticRegion+e.checkColumn.queryCheck)).map(c=>$(c).attr(e.checkColumn.attrValue))})}),apex.server.process("CHANGE_COLLECTION",{x01:"LIST",f01:JSON.stringify(l)}).done(e=>{Array.isArray(e)&&Array.from(e).forEach(e=>{let l=c.filter(c=>c.collectionName==e.collectionName)[0];Array.from(JSON.parse(e.ids)??[]).forEach(e=>{$(`${staticRegion}${l?.checkColumn.queryCheck}[${l?.checkColumn.attrValue}="${e}"]`).prop("checked",!0)}),0==Array.from(JSON.parse(e.ids)??[]).length&&$(`${staticRegion}${l?.checkColumn.queryCheck}`).prop("checked",!1)})}).fail(e=>{console.warn(e)}).always(c=>{verifyStateCheckAll(e)})}function deleteCollection(e){apex.server.process("CHANGE_COLLECTION",{x01:"DELETE",f01:JSON.stringify(e)}).done(e=>{listCollection(elemCheckArr),console.log(e)}).fail(e=>{listCollection(elemCheckArr),console.warn(e)})}function stateCheckAll(e){let c=$(staticRegion+e.checkColumn.queryCheck),l=$(staticRegion+e.checkColumn.queryCheck+":checked");c.length==l.length?$(staticRegion+e.queryCheckAll).prop("checked",!0):$(staticRegion+e.queryCheckAll).prop("checked",!1)}function verifyStateCheckAll(e){e.forEach(e=>{stateCheckAll(e)})}function eventCheckBox(e){$(`${e.staticRegion}${e.queryCheckAll}`).attr("disabled",e.disable??!1),$(`${e.staticRegion}${e.queryCheck}`).attr("disabled",e.disable??!1)}function setEventElements(e){let c=[];e.forEach(e=>{e.queryCheckAll?.length>0&&$(staticRegion+e.queryCheckAll).on("click",l=>{l.stopPropagation(),$(staticRegion+e.checkColumn.queryCheck).prop("checked",$(l.target).is(":checked")),$.map($(staticRegion+e.checkColumn.queryCheck),function(l){elemObj.id=$(l).attr(e.checkColumn.attrValue),elemObj.checked=$(l).is(":checked"),elemObj.collectionName=e.collectionName,c.push(elemObj),elemObj={id:null,checked:!1,collectionName:null}}),changeCollection(c),c=[]}),e.checkColumn?.queryCheck.length>0&&$(staticRegion+e.checkColumn.queryCheck).on("click",c=>{c.stopPropagation(),stateCheckAll(e),(elemObj={id:null,checked:!1,collectionName:null}).id=$(c.target).attr(e.checkColumn.attrValue),elemObj.checked=$(c.target).is(":checked"),elemObj.collectionName=e.collectionName,changeCollection([elemObj])}),e.buttonClear?.length>0&&$(staticRegion+e.buttonClear).on("click",c=>{c.stopImmediatePropagation(),deleteCollection({collectionName:e.collectionName})})})}function init(){createCollection(elemCheckArr),setEventElements(elemCheckArr),$(staticRegion).on("apexafterrefresh",()=>{listCollection(elemCheckArr),setEventElements(elemCheckArr)})}